Written by Benjamin Barsdell
Modified by Andrew Jameson
Modified for the use with PAF by Mateusz Malenta
